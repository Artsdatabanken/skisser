<!--shareable non dummy component-->

<div class="filter">

    <!--years-->

    <div class="select-box" *ngIf="dfYears === true" (clickElsewhere)="closeYearsPane(this)">

        <label for="fltrYear">{{ 'filters.year' | translate }}</label>


        <button class="button button--dropdown" id="fltrYear" (click)="toggleYearsDropdown()">
            {{ 'shared.select_years' | translate }}
        </button>

        <div class="select-box__field select-box__field--tall" [ngClass]="{'select-box__field--show': showYearsPane}"
            *ngIf="years">

            <div class="select-box__stripe" *ngFor="let year of years" (click)="onYearSelection(year)">

                <h2> {{ year }} </h2>

            </div>

        </div>

    </div>

    <!--years-->

    <!--species groups-->

    <div class="select-box" *ngIf="dfSpeciesGroups === true" (clickElsewhere)="closeSpeciesGroupsPane(this)">

        <label for="fltrSpeciesGroup">{{ 'filters.speciesGroup' | translate }}</label>

        <button class="button button--dropdown" id="fltrSpeciesGroup" [disabled]="isSpeciesGroupDisabled"
            (click)="toggleSpeciesGroupsDropdown()">
            {{ 'shared.select_speciesGroups' | translate }}
        </button>

        <div class="select-box__field" [ngClass]="{'select-box__field--show': showSpeciesGroupsPane}"
            *ngIf="speciesGroups$ | async as speciesGroups">

            <div class="select-box__stripe" *ngFor="let sg of speciesGroups" (click)="onSpeciesGroupsSelection(sg.id)">

                <h2>
                    <ng-container *ngIf="currentLanguage$ | async as currentLanguage">
                        {{ currentLanguage === 'no' ? sg.no : sg.en }}
                    </ng-container>
                </h2>

            </div>

        </div>

    </div>

    <!--species groups-->

    <!--taxon-->

    <div class="select-box" *ngIf="dfTaxon === true">

        <label for="fltrTaxon">{{ 'filters.taxon' | translate }}</label>

        <input class="input input--search" id="fltrTaxon" [ngModel]="activeFilters.taxon" #taxon
            (keyup)="getTaxon(taxon.value)" [disabled]="isTaxonDisabled"
            placeholder="{{ 'shared.search_searchTaxon' | translate }}">

        <div class="select-box__field" [ngClass]="{'select-box__field--show': showTaxonPane}"
            *ngIf="taxons$ | async as taxons" (clickElsewhere)="closeTaxonPane(this)">

            <div class="select-box__stripe" *ngFor="let taxon of taxons" (click)="onTaxonSelection(taxon)">

                <h2>
                    <span [ngClass]="{'text-italics': taxon.taxonCategoryId > 13}">
                        {{ taxon.scientificName.name }}
                    </span>

                    <small class="text-uppercase" *ngIf="taxon.scientificName.author">
                        {{ taxon.scientificName.author }}
                    </small>
                </h2>
                <h3>
                    {{ taxon.vernacularName?.name | lowercase }}
                    <small class="text-uppercase" *ngIf="taxon.vernacularName?.author">
                        {{ taxon.vernacularName.author }}
                    </small>
                </h3>

                <div class="select-box__details">

                    <span class="tag"
                        *ngIf="taxon.scientificNameSynonyms.length > 0 || taxon.vernacularNameSynonyms.length > 0">
                        {{ 'shared.synonyms' | translate }}
                    </span>

                    <ng-container *ngIf="taxon.scientificNameSynonyms.length > 0">

                        <div *ngFor="let synonym of taxon.scientificNameSynonyms">
                            <small [ngClass]="{'text-bold': synonym.isSearchMatch}"><i> {{ synonym.name }}
                                </i></small>
                        </div>

                    </ng-container>

                    <ng-container *ngIf="taxon.vernacularNameSynonyms.length > 0">

                        <div *ngFor="let synonym of taxon.vernacularNameSynonyms">
                            <small [ngClass]="{'text-bold': synonym.isSearchMatch}"> {{ synonym.name }} </small>
                        </div>

                    </ng-container>

                </div>

            </div>

            <div class="select-box__stripe" *ngIf="taxons.length === 0">
                {{ 'shared.noHits' | translate }}
            </div>

        </div>

    </div>

    <!--taxon-->

    <!--area-->

    <div class="select-box" *ngIf="dfArea === true">

        <label for="fltrArea">{{ 'filters.area' | translate }}</label>

        <input class="input input--search" id="fltrArea" [ngModel]="activeFilters.area" #area
            (keyup)="getArea(area.value)" placeholder="{{ 'shared.search_searchArea' | translate }}">

        <div class="select-box__field" [ngClass]="{'select-box__field--show': showAreaPane}"
            *ngIf="areas$ | async as areas" (clickElsewhere)="closeAreaPane(this)">

            <div class="select-box__stripe" *ngFor="let area of areas" (click)="onAreaSelection(area.id, area.name)">

                <h2>
                    <span> {{ area.name }} {{ area.id }}</span>
                    <ng-container *ngIf="area.name == 'Oslo'">
                        <small *ngIf="area.type == areaType.county">
                            ({{ 'shared.area_county' | translate | lowercase }})
                        </small>
                    </ng-container>
                </h2>

            </div>

            <div class="select-box__stripe" *ngIf="areas.length === 0">
                {{ 'shared.noHits' | translate }}
            </div>

        </div>

    </div>

    <!--area-->

</div>

<br>

<div class="loop loop--filters">

    <small *ngIf="showResetButton">{{ 'shared.search_chosenFilters' | translate }}: </small>

    <ng-container *ngFor="let prop of activeFilters | keyvalue">

        <button class="button button--xs button--close" *ngIf="prop.value !== null" (click)="resetFilter(prop.key)">

            <ng-container *ngIf="prop.key !== 'speciesGroup'">
                {{ prop.value }}
            </ng-container>

            <ng-container *ngIf="prop.key === 'speciesGroup'">
                <app-species-group [speciesGroupId]="prop.value"></app-species-group>
            </ng-container>

        </button>

    </ng-container>

    <button class="button button--xs button--cta" *ngIf="showResetButton" (click)="resetFilters()">
        {{ 'shared.resetFilters' | translate }}
    </button>

</div>

<!--shareable non dummy component-->